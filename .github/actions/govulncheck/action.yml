name: "govulncheck"
description: "Run govulncheck vulnerability scanner and upload SARIF report"

inputs:
  go-version:
    description: "Go version to use"
    required: false
    default: "1.25.x"

runs:
  using: "composite"
  steps:
    - id: govulncheck
      uses: nicholas-fedor/govulncheck-action@1e9ef2cbd93abefcc8605e05f8c212aa90181f6f
      with:
        output-format: sarif
        output-file: results.sarif
        go-version-input: ${{ inputs.go-version }}
    - name: Upload SARIF file
      uses: github/codeql-action/upload-sarif@e296a935590eb16afc0c0108289f68c87e2a89a5 # v4
      with:
        sarif_file: results.sarif
